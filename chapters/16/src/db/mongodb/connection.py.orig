# db.mongodb.connection

from pymongo import MongoClient

class Connection :
    
    db     = None
    client = None
<<<<<<< HEAD
    db = None

    def __init__(self, db_config) :
        keyword_args = db_config['kwargs']
        self.client = MongoClient(db_config['host'], db_config['port'], **keyword_args)

    def getClient(self) :
        return self.client

    def getDatabase(self, database = None) :
        if not self.db :
            self.db = self.client[database]
        return self.db

    def getCollection(self, collection, database = None) :
        if not self.db :
=======
        
    def __init__(self, host = 'localhost', port = 27017, result_class = dict) :
        self.client = MongoClient(host, port, result_class)

    def getClient(self) :
        return self.client
        
    def getDatabase(self, database) :
        self.db = self.client[database]
        return self.db
        
    # if collection includes a ".", assumes part before "." is the database
    def getCollection(self, collection) :
        if collection.find(".") :
            database, collection = collection.split(".",1)
>>>>>>> 60122e03f7524c3b5661537111c904b246f443b9
            self.getDatabase(database)
        return self.db[collection]
